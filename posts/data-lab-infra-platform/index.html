<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=false><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><title>Data Lab Infra - Part 3: Platform Setup with Terraform &#183; Data Lab Tech TV</title><meta name=title content="Data Lab Infra - Part 3: Platform Setup with Terraform &#183; Data Lab Tech TV"><meta name=description content="Learn how to provision Proxmox VMs with Terraform, deploying GitLab and Docker using cloud-init. Configure GitLab as a container registry, and deploy a shared runner for CI/CD using variables for secret management."><meta name=keywords content="homelab,platform,proxmox,terraform,cloud-init,gitlab,docker,video,"><link rel=canonical href=https://datalabtechtv.com/posts/data-lab-infra-platform/><link type=text/css rel=stylesheet href=/css/main.bundle.min.36c3cd7950e4533fa7da3150d972e3edf34d07f83c0264ff04cad0969dfdb3b8a7065b0ed6c730c6d34a7bad516cfc6f6a5917ab1fdb10b25f481f8a17b54c16.css integrity="sha512-NsPNeVDkUz+n2jFQ2XLj7fNNB/g8AmT/BMrQlp39s7inBlsO1scwxtNKe61RbPxvalkXqx/bELJfSB+KF7VMFg=="><script type=text/javascript src=/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script>
<script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.c3a997ddfb27a10ff9e95cf549db85ee9829ae71ffe67a18fa51cc4aa7263da105eefcb0260ed57c346263741a02fdf90aa7ea69ac3f576a789673ed2a9b7abd.js integrity="sha512-w6mX3fsnoQ/56Vz1SduF7pgprnH/5noY+lHMSqcmPaEF7vywJg7VfDRiY3QaAv35Cqfqaaw/V2p4lnPtKpt6vQ==" data-copy=Copy data-copied=Copied></script>
<script src=/lib/zoom/zoom.min.f592a181a15d2a5b042daa7f746c3721acf9063f8b6acd175d989129865a37d400ae0e85b640f9ad42cd98d1f8ad30931718cf8811abdcc5fcb264400d1a2b0c.js integrity="sha512-9ZKhgaFdKlsELap/dGw3Iaz5Bj+Las0XXZiRKYZaN9QArg6FtkD5rULNmNH4rTCTFxjPiBGr3MX8smRADRorDA=="></script>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:title" content="Data Lab Infra - Part 3: Platform Setup with Terraform"><meta property="og:description" content="Learn how to provision Proxmox VMs with Terraform, deploying GitLab and Docker using cloud-init. Configure GitLab as a container registry, and deploy a shared runner for CI/CD using variables for secret management."><meta property="og:type" content="article"><meta property="og:url" content="https://datalabtechtv.com/posts/data-lab-infra-platform/"><meta property="og:image" content="https://datalabtechtv.com/posts/data-lab-infra-platform/feature.jpeg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-09-30T12:00:00+01:00"><meta property="article:modified_time" content="2025-09-30T12:00:00+01:00"><meta property="og:site_name" content="Data Lab Tech TV"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://datalabtechtv.com/posts/data-lab-infra-platform/feature.jpeg"><meta name=twitter:title content="Data Lab Infra - Part 3: Platform Setup with Terraform"><meta name=twitter:description content="Learn how to provision Proxmox VMs with Terraform, deploying GitLab and Docker using cloud-init. Configure GitLab as a container registry, and deploy a shared runner for CI/CD using variables for secret management."><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"","name":"Data Lab Infra - Part 3: Platform Setup with Terraform","headline":"Data Lab Infra - Part 3: Platform Setup with Terraform","description":"Learn how to provision Proxmox VMs with Terraform, deploying GitLab and Docker using cloud-init. Configure GitLab as a container registry, and deploy a shared runner for CI\/CD using variables for secret management.","abstract":"Summary # On part 3 of this series, you\u0026rsquo;ll learn how to provision Proxmox VMs with Terraform, using QEMU to build on top of the Ubuntu\u0026rsquo;s official cloud image (qcow2).","inLanguage":"en","url":"https:\/\/datalabtechtv.com\/posts\/data-lab-infra-platform\/","author":{"@type":"Person","name":"Data Lab Tech"},"copyrightYear":"2025","dateCreated":"2025-09-30T12:00:00\u002b01:00","datePublished":"2025-09-30T12:00:00\u002b01:00","dateModified":"2025-09-30T12:00:00\u002b01:00","keywords":["homelab","platform","proxmox","terraform","cloud-init","gitlab","docker","video"],"mainEntityOfPage":"true","wordCount":"2940"}]</script><meta name=author content="Data Lab Tech"><link href=https://youtube.com/@DataLabTechTV rel=me><link href=https://bsky.app/profile/datalabtechtv.com rel=me><link href=https://github.com/DataLabTechTV rel=me><link href=https://discord.gg/6xpe827ANZ rel=me><script src=/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-VQTLJTJJ7T"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("consent","default",{analytics_storage:"denied",ad_storage:"denied"}),gtag("js",new Date),gtag("config","G-VQTLJTJJ7T",{anonymize_ip:!0,allow_google_signals:!1})</script><script>MathJax={tex:{inlineMath:[["$","$"]]},svg:{fontCache:"global"}}</script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js></script><style>.medium-zoom-overlay{background:rgba(0,0,0,.9)!important;z-index:100}.of-wide{width:150%;margin-left:-25%;height:auto}.of-narrow{width:125%;height:auto}</style><meta name=theme-color></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 min-h-[130px] opacity-65 pl-[24px] pr-[24px] bg-gradient-to-b from-neutral from-60% dark:from-neutral-800 to-transparent mix-blend-normal" style=z-index:80></div><div class="fixed inset-x-0 pl-[24px] pr-[24px]" style=z-index:100><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl"></div><div class="relative max-w-[64rem] ml-auto mr-auto"><div style=padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3"><div><a href=/ class=flex><span class=sr-only>Data Lab Tech TV</span>
<img src=/img/logo.png width=450 height=450 class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt="Data Lab Tech TV"></a></div><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium text-gray-500 hover:text-gray-900">Data Lab Tech TV</a></nav><nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12"><a href=/posts/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title>Blog</p></a><a href=https://youtube.com/@DataLabTechTV target=_blank class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><span class=mr-1><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78.0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg></span></span><p class="text-base font-medium" title>YouTube</p></a><a href=https://bsky.app/profile/datalabtechtv.com target=_blank class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><span class=mr-1><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 232.562c-21.183-41.196-78.868-117.97-132.503-155.834-51.378-36.272-70.978-29.987-83.828-24.181-14.872 6.72-17.577 29.554-17.577 42.988.0 13.433 7.365 110.138 12.169 126.281 15.873 53.336 72.376 71.358 124.413 65.574 2.66-.395 5.357-.759 8.089-1.097-2.68.429-5.379.796-8.089 1.097-76.259 11.294-143.984 39.085-55.158 137.972C201.224 526.527 237.424 403.67 256 341.379c18.576 62.291 39.972 180.718 150.734 83.983 83.174-83.983 22.851-126.674-53.408-137.969-2.71-.302-5.409-.667-8.089-1.096 2.732.337 5.429.702 8.089 1.096 52.037 5.785 108.54-12.239 124.413-65.574 4.804-16.142 12.169-112.847 12.169-126.281.0-13.434-2.705-36.267-17.577-42.988-12.85-5.806-32.45-12.09-83.829 24.181C334.868 114.595 277.183 191.366 256 232.562z"/></svg></span></span><p class="text-base font-medium" title>Bluesky</p></a><a href=/tags/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title=Tags>Tags</p></a><div><div class="cursor-pointer flex items-center nested-menu"><a class="text-base font-medium text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title>Categories</a>
<span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></div><div class="absolute menuhide"><div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl"><div class="flex flex-col space-y-3"><a href=/categories/data-science/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-sm" style=white-space:nowrap title="Data Science">Data Science</p></a><a href=/categories/data-engineering/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-sm" style=white-space:nowrap title="Data Engineering">Data Engineering</p></a><a href=/categories/mlops/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-sm" style=white-space:nowrap title=MLOps>MLOps</p></a><a href=/categories/devops/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-sm" style=white-space:nowrap title=DevOps>DevOps</p></a><a href=/categories/software-engineering/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-sm" style=white-space:nowrap title="Software Engineering">Software Engineering</p></a><a href class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-sm" style=white-space:nowrap title>Philosophy of Technology</p></a></div></div></div></div><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button></nav><div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12"><span></span>
<button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button></div></div><div class="-my-2 md:hidden"><label id=menu-button class=block><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper style=padding-top:5px class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl"><li id=menu-close-button><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/posts/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>Blog</p></a></li><li class=mt-1><a href=https://youtube.com/@DataLabTechTV target=_blank class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><div class=mr-2><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78.0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg></span></div><p class="text-bg font-bg" title>YouTube</p></a></li><li class=mt-1><a href=https://bsky.app/profile/datalabtechtv.com target=_blank class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><div class=mr-2><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 232.562c-21.183-41.196-78.868-117.97-132.503-155.834-51.378-36.272-70.978-29.987-83.828-24.181-14.872 6.72-17.577 29.554-17.577 42.988.0 13.433 7.365 110.138 12.169 126.281 15.873 53.336 72.376 71.358 124.413 65.574 2.66-.395 5.357-.759 8.089-1.097-2.68.429-5.379.796-8.089 1.097-76.259 11.294-143.984 39.085-55.158 137.972C201.224 526.527 237.424 403.67 256 341.379c18.576 62.291 39.972 180.718 150.734 83.983 83.174-83.983 22.851-126.674-53.408-137.969-2.71-.302-5.409-.667-8.089-1.096 2.732.337 5.429.702 8.089 1.096 52.037 5.785 108.54-12.239 124.413-65.574 4.804-16.142 12.169-112.847 12.169-126.281.0-13.434-2.705-36.267-17.577-42.988-12.85-5.806-32.45-12.09-83.829 24.181C334.868 114.595 277.183 191.366 256 232.562z"/></svg></span></div><p class="text-bg font-bg" title>Bluesky</p></a></li><li class=mt-1><a href=/tags/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title=Tags>Tags</p></a></li><li class=mt-1><a href class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>Categories</p><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></a></li><li class=mt-1><a href=/categories/data-science/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-small" title="Data Science">Data Science</p></a></li><li class=mt-1><a href=/categories/data-engineering/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-small" title="Data Engineering">Data Engineering</p></a></li><li class=mt-1><a href=/categories/mlops/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-small" title=MLOps>MLOps</p></a></li><li class=mt-1><a href=/categories/devops/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-small" title=DevOps>DevOps</p></a></li><li class=mt-1><a href=/categories/software-engineering/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-small" title="Software Engineering">Software Engineering</p></a></li><li class=mt-1><a href class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-small" title>Philosophy of Technology</p></a></li><li class=mb-2></li></ul></div></label></div></div></div></div><script>window.addEventListener("scroll",function(){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,n=document.getElementById("menu-blur");n.style.opacity=t/300})</script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom" style=background-image:url(/img/background_hu8d68b17e3ffc912a5df269076751b47e_2170219_1200x0_resize_box_3.png)><div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div><div class="absolute inset-0 opacity-30 dark:opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral dark:to-neutral-800 mix-blend-normal"></div></div><div id=background-blur class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div><script>window.addEventListener("scroll",function(){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,n=document.getElementById("background-blur");n.style.opacity=t/300})</script><header id=single_header class="mt-5 max-w-prose"><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Data Lab Infra - Part 3: Platform Setup with Terraform</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2025-09-30T12:00:00+01:00>30 September 2025</time><span class="px-2 text-primary-500">&#183;</span><span>2940 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">14 mins</span></div><div class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='return window.open("/categories/devops/","_self"),!1'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">DevOps</span></span></span>
<span style=margin-top:.5rem class=mr-2 onclick='return window.open("/tags/homelab/","_self"),!1'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">homelab</span></span></span>
<span style=margin-top:.5rem class=mr-2 onclick='return window.open("/tags/platform/","_self"),!1'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">platform</span></span></span>
<span style=margin-top:.5rem class=mr-2 onclick='return window.open("/tags/proxmox/","_self"),!1'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">proxmox</span></span></span>
<span style=margin-top:.5rem class=mr-2 onclick='return window.open("/tags/terraform/","_self"),!1'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">terraform</span></span></span>
<span style=margin-top:.5rem class=mr-2 onclick='return window.open("/tags/cloud-init/","_self"),!1'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">cloud-init</span></span></span>
<span style=margin-top:.5rem class=mr-2 onclick='return window.open("/tags/gitlab/","_self"),!1'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">gitlab</span></span></span>
<span style=margin-top:.5rem class=mr-2 onclick='return window.open("/tags/docker/","_self"),!1'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">docker</span></span></span>
<span style=margin-top:.5rem class=mr-2 onclick='return window.open("/tags/video/","_self"),!1'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">video</span></span></span></div></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8"><div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-[140px]"><details open id=TOCView class="toc-right mt-0 overflow-y-scroll overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#summary>Summary</a></li><li><a href=#resource-planning>Resource Planning</a></li><li><a href=#backup-strategy>Backup Strategy?</a></li><li><a href=#docker-vms>Docker VMs</a><ul><li><a href=#cloud-init>Cloud-Init</a></li><li><a href=#client-access>Client Access</a></li></ul></li><li><a href=#gitlab-vm>GitLab VM</a><ul><li><a href=#minio-bucket>MinIO Bucket</a></li><li><a href=#cloud-init-1>Cloud-Init</a></li><li><a href=#testing>Testing</a><ul><li><a href=#repository-management>Repository Management</a></li><li><a href=#container-registry>Container Registry</a></li><li><a href=#cicd-workflows>CI/CD Workflows</a></li></ul></li></ul></li><li><a href=#final-remarks>Final Remarks</a><ul><li><a href=#on-configuration-management>On Configuration Management&mldr;</a></li><li><a href=#on-gitlab>On GitLab&mldr;</a></li></ul></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#summary>Summary</a></li><li><a href=#resource-planning>Resource Planning</a></li><li><a href=#backup-strategy>Backup Strategy?</a></li><li><a href=#docker-vms>Docker VMs</a><ul><li><a href=#cloud-init>Cloud-Init</a></li><li><a href=#client-access>Client Access</a></li></ul></li><li><a href=#gitlab-vm>GitLab VM</a><ul><li><a href=#minio-bucket>MinIO Bucket</a></li><li><a href=#cloud-init-1>Cloud-Init</a></li><li><a href=#testing>Testing</a><ul><li><a href=#repository-management>Repository Management</a></li><li><a href=#container-registry>Container Registry</a></li><li><a href=#cicd-workflows>CI/CD Workflows</a></li></ul></li></ul></li><li><a href=#final-remarks>Final Remarks</a><ul><li><a href=#on-configuration-management>On Configuration Management&mldr;</a></li><li><a href=#on-gitlab>On GitLab&mldr;</a></li></ul></li></ul></nav></div></details><script>var margin=200,marginError=50;(function(){var t=$(window),e=$("#TOCView"),s=e.height();function n(){var n=t.height()-margin;s>=n?(e.css("overflow-y","scroll"),e.css("max-height",n+marginError+"px")):(e.css("overflow-y","hidden"),e.css("max-height","9999999px"))}t.on("resize",n),$(document).ready(n)})()</script></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><h2 class="relative group">Summary<div id=summary class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#summary aria-label=Anchor>#</a></span></h2><p>On part 3 of this series, you&rsquo;ll learn how to provision Proxmox VMs with Terraform, using QEMU to build on top of the Ubuntu&rsquo;s official cloud image (qcow2).</p><p>We&rsquo;ll deploy GitLab and Docker using cloud-init, configuring GitLab as a container registry, and deploying a shared Docker runner for CI/CD that executes on a separate VM.</p><p>We&rsquo;ll also learn how to setup CI/CD variables and secrets, and how to write a simple CI/CD job, using a <code>.gitlab-ci.yaml</code> file, to print information about the runner instance, as well as a couple of variables that we set in via the web UI.</p><p>Again, keep in mind that these skills are loosely transferable to cloud platforms like AWS, GCP or Azure, with the advantage that it costs zero to setup Proxmox at home, if you&rsquo;ve got some old hardware lying around.</p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden;max-width:100%><iframe src=https://www.youtube.com/embed/C5nOC3TQDjU frameborder=0 allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy=strict-origin-when-cross-origin allowfullscreen style=position:absolute;top:0;left:0;width:100%;height:100%>></iframe></div><h2 class="relative group">Resource Planning<div id=resource-planning class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#resource-planning aria-label=Anchor>#</a></span></h2><p>Our Proxmox node has 16 CPU cores, 32 GiB RAM, and a 1 TiB hard drive, that we can allocate to CTs and VMs. For the foundation layer (L1), we allocated 2 CPU cores and 2048 MiB RAM to an LXC, but, for the platform layer (L2), we&rsquo;ll need to plan a bit better, as L2 handles the most load, particularly on the <code>docker-shared</code> VM, as it runs all core services that are accessed by the other data stack components and applications.</p><p>We also want to keep 2 CPU cores available to the Proxmox hypervisor at all times. Proxmox also requires a minimum of 1 GiB RAM to run, but our node was using 2 GiB RAM, so this is our target free RAM.</p><p>Below, we plan global memory allocation based on the maximum active memory for a single VM, while assuming other VMs remain at the minimum usage set by floating memory. Such an assumption is based on the fact that this infrastructure will be used by a single person. You should do a similar exercise for your hardware and use case, but the overall logic remains useful.</p><p>Notice that we might still observe a heavy load on <code>gitlab</code>, <code>docker-gitlab</code>, and <code>docker-shared</code>, at the same timeâ€”e.g., <code>gitlab</code> launches a <code>docker-gitlab</code> runner to update the docker compose stack on <code>docker-shared</code>. Regardless, the worst case scenario based on a single VM is still a good average to target.</p><p>Below, you find the resource allocation table for all the CTs and VMs in our Proxmox node. You&rsquo;ll find the ID and name for the VM or CT, along with the allocated number of CPU cores, disk space (GiB), dedicated memory (MiB), and floating memory (MiB). We also include a &ldquo;Free on Max.&rdquo; column with the free or unallocated memory when the given VM is using all of its dedicated memory. This is calculated by subtracting the total floating memory (22,528 MiB) and the difference between the VM&rsquo;s dedicated and floating memory (e.g., 20,480 MiB and 12,288 MiB for VM 203) from the total available memory (32,768 MiB). As such, for VM 203, the free memory on maximum usage is calculated as $32768 - 22528 - (20480 - 12288) = 2048$.</p><table><thead><tr><th>ID</th><th>VM/CT</th><th style=text-align:right>Cores</th><th style=text-align:right>Disk</th><th style=text-align:right>Dedicated Mem.</th><th style=text-align:right>Floating Mem.</th><th style=text-align:right>Free on Max.</th></tr></thead><tbody><tr><td>101</td><td><code>minio</code></td><td style=text-align:right>2</td><td style=text-align:right>200</td><td style=text-align:right>2048</td><td style=text-align:right>2048</td><td style=text-align:right>10240</td></tr><tr><td>201</td><td><code>gitlab</code></td><td style=text-align:right>1</td><td style=text-align:right>100</td><td style=text-align:right>6144</td><td style=text-align:right>2048</td><td style=text-align:right>6144</td></tr><tr><td>202</td><td><code>docker-gitlab</code></td><td style=text-align:right>1</td><td style=text-align:right>100</td><td style=text-align:right>6144</td><td style=text-align:right>2048</td><td style=text-align:right>6144</td></tr><tr><td>203</td><td><code>docker-shared</code></td><td style=text-align:right>8</td><td style=text-align:right>200</td><td style=text-align:right>20480</td><td style=text-align:right>12288</td><td style=text-align:right>2048</td></tr><tr><td>204</td><td><code>docker-apps</code></td><td style=text-align:right>2</td><td style=text-align:right>100</td><td style=text-align:right>12288</td><td style=text-align:right>4096</td><td style=text-align:right>2048</td></tr><tr><td><strong>ALL</strong></td><td><strong>TOTALS</strong></td><td style=text-align:right><strong>14</strong></td><td style=text-align:right><strong>700</strong></td><td style=text-align:right><strong>47104</strong></td><td style=text-align:right><strong>22528</strong></td><td style=text-align:right><strong>-14336</strong></td></tr></tbody></table><p>As we can see, worst case scenario, assuming maximum memory usage only happens for a single VM at a time, we get 2,048 MiB RAM free at all times.</p><p>If we look at the totals, we find only 14 CPU cores were allocated, leaving 2 cores for Proxmox, as required. We can also see that, at maximum usage for all CTs and VMs, our system would require 14,336 MiB of additional RAM.</p><p>This is an estimate, but, with real-world usage statistics, we can better tune VM configurations simply by editing our Terraform variables for <code>cpu.cores</code> and <code>memory.*</code>. And, if there aren&rsquo;t enough resources, this is a good reason to go look for a mini PC to expand our home lab! ðŸ˜‰</p><h2 class="relative group">Backup Strategy?<div id=backup-strategy class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#backup-strategy aria-label=Anchor>#</a></span></h2><p>During foundation layer deployment, we had setup a separate volume for <code>/data</code>. In most cloud platforms, we can easily detach a data volume while recreating the root volume, or even create snapshots for it that we can later restore. On the other hand, Proxmox only provides snapshots for the whole VM, which is not practical to manage as a backup solution. As such, we simplified our MinIO LXC to use a single root disk, and we do the same for the VMs in the platform layer.</p><p>Backups will be added later on and they will be application-specific. The overall strategy will be based on mounting an external volume from a NAS under <code>/backups</code> for each VM, and scheduling a backup process based on a systemd timer and service, which will write to that directory.</p><p>For our current use-case, backups are not particularly concerning, as we can always re-ingest our lakehouse datasets, or recreate our GitLab repos, as these will only be used for CI/CD, which obvious also require that Docker images are re-registered, and variables and secrets are re-added. While this might justify setting up a proper backup strategy, failure wouldn&rsquo;t be catastrophic. This is perfectly fine for a home lab setting, where we&rsquo;re constantly tearing down and re-deploying our infrastructure.</p><h2 class="relative group">Docker VMs<div id=docker-vms class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#docker-vms aria-label=Anchor>#</a></span></h2><p>We&rsquo;ll provision three Docker VMs using <a href=https://developer.hashicorp.com/terraform target=_blank>Terraform</a>, the <a href=https://registry.terraform.io/providers/bpg/proxmox/latest target=_blank>bpg/proxmox</a> provider, and <a href=https://cloudinit.readthedocs.io/en/latest/ target=_blank>cloud-init</a>:</p><ul><li><code>docker-gitlab</code>, where our GitLab Runner will run CI/CD jobs;</li><li><code>docker-shared</code>, to deploy the core services for our data stack (PostgreSQL, Apache Kafka, etc.);</li><li><code>docker-apps</code>, where project-specific services will live.</li></ul><h3 class="relative group">Cloud-Init<div id=cloud-init class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#cloud-init aria-label=Anchor>#</a></span></h3><p>Wait, so did we drop Packer? Yes, we did. We ended up going with a simpler cloud-init config instead, since there really isn&rsquo;t much to deploy on each VM, or too much to gain from building a single image to deploy only three Docker VMs. We might still do Packer in the future, for the educational value, but, for the home lab, we want to keep it as minimalistic as possible.</p><p>Here&rsquo;s the cloud-init config that we used to setup our Docker VMs. This was directly extracted from our Terraform config, which is currently available at the <code>dev</code> branch of the <a href=https://github.com/DataLabTechTV/datalab/ target=_blank>datalab</a> repo, so you&rsquo;ll find <code>${...}</code> blocks which represent variable or resource output replacements.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c>#cloud-config</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>hostname</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;${local.docker[count.index].name}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>password</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;${random_password.docker_vm[count.index].result}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>chpasswd</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>expire</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>ssh_pwauth</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apt</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>sources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nt>docker</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  </span><span class=nt>source</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;deb [arch=amd64 signed-by=/etc/apt/trusted.gpg.d/docker.gpg] https://download.docker.com/linux/ubuntu noble stable&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=l>${indent(8, chomp(data.http.docker_gpg.response_body))}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>package_update</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>package_upgrade</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>packages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>qemu-guest-agent</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>docker-ce</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>write_files</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/etc/systemd/system/docker.service.d/override.conf</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nt>owner</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;root:root&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nt>permissions</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;0600&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nt>content</span><span class=p>:</span><span class=w> </span><span class=l>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  </span><span class=p>[</span><span class=l>Service]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  </span><span class=l>ExecStart=</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  </span><span class=l>ExecStart=/usr/bin/dockerd</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/etc/docker/daemon.json</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nt>owner</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;root:root&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nt>permissions</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;0600&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nt>content</span><span class=p>:</span><span class=w> </span><span class=l>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  </span>{<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=nt>&#34;hosts&#34;: </span><span class=p>[</span><span class=s2>&#34;fd://&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;tcp://0.0.0.0:2375&#34;</span><span class=p>],</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=nt>&#34;containerd&#34;: </span><span class=s2>&#34;/run/containerd/containerd.sock&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  </span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>runcmd</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>systemctl enable --now qemu-guest-agent</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>netplan apply</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>usermod -aG docker ubuntu</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>reboot</span><span class=w>
</span></span></span></code></pre></div><p>We use the <code>apt</code> block to add the official repo for Docker, so that we can install <code>docker-ce</code> with the latest version of Docker. Then, we override the config for <code>docker.service</code>, which essentially means removing the arguments from <code>dockerd</code> so that <code>/etc/docker/daemon.json</code> gets used instead. We then reproduce the original CLI config and add <code>tcp://0.0.0.0:2375</code> to the listening hosts for Docker. This will let us access Docker externally, as described in the following section.</p><h3 class="relative group">Client Access<div id=client-access class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#client-access aria-label=Anchor>#</a></span></h3><p>On your local machine, create a context for each Docker VM:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker context create docker-gitlab --docker <span class=s2>&#34;host=tcp://docker-gitlab:2375&#34;</span>
</span></span><span class=line><span class=cl>docker context create docker-shared --docker <span class=s2>&#34;host=tcp://docker-shared:2375&#34;</span>
</span></span><span class=line><span class=cl>docker context create docker-apps --docker <span class=s2>&#34;host=tcp://docker-apps:2375&#34;</span>
</span></span></code></pre></div><p>You can then switch to any context and run Docker commands as usual:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker context use docker-gitlab
</span></span><span class=line><span class=cl>docker ps
</span></span></code></pre></div><p>Often, custom shell prompts, like <a href=https://starship.rs/ target=_blank>Starship</a>, will display your current Docker context, when it&rsquo;s something other than the default ones. I definitely recommend Starship for this, as it supports any shell, including Bash, Fish, or even PowerShell, and it will display your Docker context by default.</p><h2 class="relative group">GitLab VM<div id=gitlab-vm class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#gitlab-vm aria-label=Anchor>#</a></span></h2><p>We&rsquo;ll provision a GitLab instance, which will power multiple features of our home lab, including the container registry for custom docker imagesâ€”be it our own project-specific services or extended installations for core servicesâ€”and also GitOps, using CI/CD to run docker compose deployment jobs, along with variables to store configurations and secrets.</p><h3 class="relative group">MinIO Bucket<div id=minio-bucket class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#minio-bucket aria-label=Anchor>#</a></span></h3><p>As a requirement to setup the container registry component, we added the <code>gitlab</code> bucket to our foundation layer MinIO instance, both to the provisioning config and manually via <code>mc</code> (to avoid redeploying):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> infra/foundation
</span></span><span class=line><span class=cl>mc <span class=nb>alias</span> <span class=nb>set</span> lab http://minio:9000 admin <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	<span class=k>$(</span>terraform output -raw minio_admin_password<span class=k>)</span>
</span></span><span class=line><span class=cl>mc mb lab/gitlab
</span></span></code></pre></div><p>This is used on the cloud-init config shown in the following section.</p><h3 class="relative group">Cloud-Init<div id=cloud-init-1 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#cloud-init-1 aria-label=Anchor>#</a></span></h3><p>Here&rsquo;s the cloud-init config that we used to setup our GitLab VM:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c>#cloud-config</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>hostname</span><span class=p>:</span><span class=w> </span><span class=l>${local.gitlab.name}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>password</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;${random_password.gitlab_vm.result}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>chpasswd</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>expire</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>ssh_pwauth</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>package_update</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>package_upgrade</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>packages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>qemu-guest-agent</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>curl</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>write_files</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/etc/gitlab/gitlab.rb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nt>owner</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;root:root&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nt>permissions</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;0600&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nt>content</span><span class=p>:</span><span class=w> </span><span class=l>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  </span><span class=l>external_url &#39;http://${local.gitlab.name}&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  </span><span class=l>gitlab_rails[&#39;initial_root_password&#39;] = &#39;${random_password.gitlab_root.result}&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  </span><span class=l>gitlab_rails[&#39;registry_enabled&#39;] = true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  </span><span class=l>registry_external_url &#39;http://${local.gitlab.name}:5050&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  </span><span class=l>registry[&#39;database&#39;] = {</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=s1>&#39;enabled&#39;</span><span class=w> </span><span class=l>=&gt; true,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  </span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  </span><span class=l>registry[&#39;storage&#39;] = {</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=s1>&#39;s3_v2&#39;</span><span class=w> </span><span class=l>=&gt; {</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		  </span><span class=s1>&#39;regionendpoint&#39;</span><span class=w> </span><span class=l>=&gt; &#39;${var.s3_endpoint}&#39;,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		  </span><span class=s1>&#39;region&#39;</span><span class=w> </span><span class=l>=&gt; &#39;${var.s3_region}&#39;,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		  </span><span class=s1>&#39;accesskey&#39;</span><span class=w> </span><span class=l>=&gt; &#39;${var.s3_access_key}&#39;,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		  </span><span class=s1>&#39;secretkey&#39;</span><span class=w> </span><span class=l>=&gt; &#39;${var.s3_secret_key}&#39;,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		  </span><span class=s1>&#39;pathstyle&#39;</span><span class=w> </span><span class=l>=&gt; ${var.s3_path_style},</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		  </span><span class=s1>&#39;bucket&#39;</span><span class=w> </span><span class=l>=&gt; &#39;${var.gitlab_s3_registry_bucket}&#39;,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  </span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>runcmd</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>systemctl enable --now qemu-guest-agent</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>netplan apply</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>curl &#34;https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.deb.sh&#34; | sudo bash</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>apt install -y gitlab-ce</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>gitlab-ctl reconfigure</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=l>gitlab-rails console -e production &lt;&lt;EOT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  </span><span class=l>s = ApplicationSetting.current</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  </span><span class=l>s.update!(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=nt>signup_enabled</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=nt>version_check_enabled</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=nt>usage_ping_enabled</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=nt>usage_ping_generation_enabled</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=nt>whats_new_variant</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;disabled&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  </span><span class=l>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=l>EOT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>curl -L https://packages.gitlab.com/install/repositories/runner/gitlab-runner/script.deb.sh | sudo bash</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>apt install -y gitlab-runner</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=l>gitlab-runner register --non-interactive \</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  </span>--<span class=l>url &#34;http://${local.gitlab.name}/&#34; \</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  </span>--<span class=l>registration-token &#34;$(gitlab-rails runner &#39;puts ApplicationSetting.current.runners_registration_token&#39;)&#34; \</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  </span>--<span class=l>executor &#34;docker&#34; \</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  </span>--<span class=l>docker-image &#34;ubuntu:latest&#34; \</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  </span>--<span class=l>description &#34;ubuntu-latest-runner&#34; \</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  </span>--<span class=l>tag-list &#34;docker,remote,ubuntu&#34; \</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  </span>--<span class=l>run-untagged=&#34;true&#34; \</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	  </span>--<span class=l>docker-host &#34;tcp://${local.docker[0].name}:2375&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>reboot</span><span class=w>
</span></span></span></code></pre></div><p>Let&rsquo;s break it down into. We begin by setting a few basic properties for the VM, including its hostname and password (setting to not expire, thus avoiding having to change it on the first login). We also enable password authentication for SSH, so that we can login with the default <code>ubuntu</code> user.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c>#cloud-config</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>hostname</span><span class=p>:</span><span class=w> </span><span class=l>${local.gitlab.name}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>password</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;${random_password.gitlab_vm.result}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>chpasswd</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>expire</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>ssh_pwauth</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span></code></pre></div><p>Then, we update the system packages and install the guest agent to help Proxmox monitor the VM and handle memory ballooning, and we install <code>curl</code>, which will be required during GitLab installation.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>package_update</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>package_upgrade</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>packages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>qemu-guest-agent</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>curl</span><span class=w>
</span></span></span></code></pre></div><p>Next, we write the <code>gitlab.rb</code> file, which is used to configure GitLab when running <code>gitlab-ctl reconfigure</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>write_files</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/etc/gitlab/gitlab.rb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nt>owner</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;root:root&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nt>permissions</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;0600&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nt>content</span><span class=p>:</span><span class=w> </span><span class=l>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=l>...</span><span class=w>
</span></span></span></code></pre></div><p>You&rsquo;ll find the <code>content</code> value below. We set the <code>external_url</code> to the host where GitLab will run, as well as the initial root account password. We then enable the container registry, setting it up to use the existing database, as well as our existing MinIO instance, with the newly created bucket, to store the image layers that will be pushed to the container. As you can see, most of these settings are directly managed via Terraform variables.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=n>external_url</span> <span class=s1>&#39;http://${local.gitlab.name}&#39;</span>
</span></span><span class=line><span class=cl><span class=n>gitlab_rails</span><span class=o>[</span><span class=s1>&#39;initial_root_password&#39;</span><span class=o>]</span> <span class=o>=</span> <span class=s1>&#39;${random_password.gitlab_root.result}&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>gitlab_rails</span><span class=o>[</span><span class=s1>&#39;registry_enabled&#39;</span><span class=o>]</span> <span class=o>=</span> <span class=kp>true</span>
</span></span><span class=line><span class=cl><span class=n>registry_external_url</span> <span class=s1>&#39;http://${local.gitlab.name}:5050&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>registry</span><span class=o>[</span><span class=s1>&#39;database&#39;</span><span class=o>]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=s1>&#39;enabled&#39;</span> <span class=o>=&gt;</span> <span class=kp>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>registry</span><span class=o>[</span><span class=s1>&#39;storage&#39;</span><span class=o>]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=s1>&#39;s3_v2&#39;</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=s1>&#39;regionendpoint&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;${var.s3_endpoint}&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=s1>&#39;region&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;${var.s3_region}&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=s1>&#39;accesskey&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;${var.s3_access_key}&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=s1>&#39;secretkey&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;${var.s3_secret_key}&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=s1>&#39;pathstyle&#39;</span> <span class=o>=&gt;</span> <span class=err>$</span><span class=p>{</span><span class=n>var</span><span class=o>.</span><span class=n>s3_path_style</span><span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=s1>&#39;bucket&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;${var.gitlab_s3_registry_bucket}&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Finally, under the <code>runcmd</code> block, which is an array of commands, we&rsquo;ll essentially run the following script, which we reformat and comment:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># This enables and starts the guest agent.</span>
</span></span><span class=line><span class=cl>systemctl <span class=nb>enable</span> --now qemu-guest-agent
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># This ensures that the hostname is broadcast to DHCP, otherwise</span>
</span></span><span class=line><span class=cl><span class=c1># we&#39;d need to sign in once using the IP address.</span>
</span></span><span class=line><span class=cl>netplan apply
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Here we install GitLab, but this doesn&#39;t start it.</span>
</span></span><span class=line><span class=cl>curl <span class=s2>&#34;https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.deb.sh&#34;</span> <span class=p>|</span> sudo bash
</span></span><span class=line><span class=cl>apt install -y gitlab-ce
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># This will configure and start GitLab using the settings from</span>
</span></span><span class=line><span class=cl><span class=c1># /etc/gitlab/gitlab.rb.</span>
</span></span><span class=line><span class=cl>gitlab-ctl reconfigure
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>gitlab-rails console -e production <span class=s>&lt;&lt;EOT
</span></span></span><span class=line><span class=cl><span class=s>  s = ApplicationSetting.current
</span></span></span><span class=line><span class=cl><span class=s>  s.update!(
</span></span></span><span class=line><span class=cl><span class=s>	signup_enabled: false,
</span></span></span><span class=line><span class=cl><span class=s>	version_check_enabled: false,
</span></span></span><span class=line><span class=cl><span class=s>	usage_ping_enabled: false,
</span></span></span><span class=line><span class=cl><span class=s>	usage_ping_generation_enabled: false,
</span></span></span><span class=line><span class=cl><span class=s>	whats_new_variant: &#39;disabled&#39;
</span></span></span><span class=line><span class=cl><span class=s>  )
</span></span></span><span class=line><span class=cl><span class=s>EOT</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># We also install the GitLab Runner locally.</span>
</span></span><span class=line><span class=cl>curl -L https://packages.gitlab.com/install/repositories/runner/gitlab-runner/script.deb.sh <span class=p>|</span> sudo bash
</span></span><span class=line><span class=cl>apt install -y gitlab-runner
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># And we set it up as a shared runner that executes using an Ubuntu</span>
</span></span><span class=line><span class=cl><span class=c1># image on a separate Docker VM (docker-gitlab).</span>
</span></span><span class=line><span class=cl>gitlab-runner register --non-interactive <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --url <span class=s2>&#34;http://</span><span class=si>${</span><span class=nv>local</span><span class=p>.gitlab.name</span><span class=si>}</span><span class=s2>/&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --registration-token <span class=s2>&#34;</span><span class=k>$(</span>gitlab-rails runner <span class=s1>&#39;puts ApplicationSetting.current.runners_registration_token&#39;</span><span class=k>)</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --executor <span class=s2>&#34;docker&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --docker-image <span class=s2>&#34;ubuntu:latest&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --description <span class=s2>&#34;ubuntu-latest-runner&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --tag-list <span class=s2>&#34;docker,remote,ubuntu&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --run-untagged<span class=o>=</span><span class=s2>&#34;true&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --docker-host <span class=s2>&#34;tcp://</span><span class=si>${</span><span class=nv>local</span><span class=p>.docker[0].name</span><span class=si>}</span><span class=s2>:2375&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># We reboot, as it&#39;s likely Ubuntu will ask you to anyway, on first</span>
</span></span><span class=line><span class=cl><span class=c1># login.</span>
</span></span><span class=line><span class=cl>reboot
</span></span></code></pre></div><h3 class="relative group">Testing<div id=testing class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#testing aria-label=Anchor>#</a></span></h3><h4 class="relative group">Repository Management<div id=repository-management class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#repository-management aria-label=Anchor>#</a></span></h4><p>In order to test a basic git repo workflow, we do the following:</p><ol><li>Create a new user with the root account, e.g., <code>datalabtechtv</code>.</li><li>Edit the user to be able to set a default password.</li><li>Sign in to the new user and change your password</li><li>Create a <code>sandbox</code> repo.</li><li>Generate a <code>gitlab</code> SSH key on the client machine.</li><li>Add the SSH key to the new user&rsquo;s settings.</li><li>Clone the <code>sandbox</code> repo on the client machine.</li></ol><h4 class="relative group">Container Registry<div id=container-registry class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#container-registry aria-label=Anchor>#</a></span></h4><p>For testing the container registry, on the cloned <code>sandbox</code> repo, we create the following <code>Dockerfile</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Dockerfile data-lang=Dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> ubuntu:latest</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span><span class=s2>&#34;echo&#34;</span><span class=p>,</span> <span class=s2>&#34;Hello GitLab Container Registry!&#34;</span><span class=p>]</span><span class=err>
</span></span></span></code></pre></div><p>We can optionally commit and push it:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git add Dockerfile
</span></span><span class=line><span class=cl>git config user.name <span class=s2>&#34;Data Lab Tech TV&#34;</span>
</span></span><span class=line><span class=cl>git config user.email <span class=s2>&#34;mail@datalabtechtv.com&#34;</span>
</span></span><span class=line><span class=cl>git commit Dockerfile -m <span class=s2>&#34;feat: add a testing Dockerfile&#34;</span>
</span></span><span class=line><span class=cl>git push
</span></span></code></pre></div><p>Because we&rsquo;re not using SSL for our GitLab instance, we&rsquo;ll need to add the following config to <code>/etc/docker/daemon.json</code> on our client machine (also available via Docker Desktop, under Settings â†’ Docker Engine):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;insecure-registries&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;gitlab:5050&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>We can optionally create a personal access token (PAT) with <code>read_registry</code> and <code>write_registry</code> permissions for our user account, under Settings â†’ Access tokens to use as a password, but we can also login using our regular user and password, which is what we do. Either way, the command is the same:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker login gitlab:5050
</span></span></code></pre></div><p>We can then build, tag, and push an image, making sure our tag includes the user account (e.g., <code>datalabtechtv</code>) and the project/repo name (e.g., <code>sandbox</code>), followed by our image name and version (e.g., <code>test:latest</code>):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker build -t test:latest .
</span></span><span class=line><span class=cl>docker tag test:latest gitlab:5050/datalabtechtv/sandbox/test:latest
</span></span><span class=line><span class=cl>docker push gitlab:5050/datalabtechtv/sandbox/test:latest
</span></span></code></pre></div><p>Once this is done, the image should be listed on GitLab&rsquo;s UI under Deploy â†’ Container registry for the <code>sandbox</code> project. I recommend that you pin Container registry, as we&rsquo;ll be using it often on our home lab in the future.</p><p><figure><img class="my-0 rounded-md" loading=lazy src=./data-lab-infra-platform-container-registry.png alt="Data Lab Infra - Platform - Container Registry"></figure></p><p>Also, check the <code>gitlab</code> bucket on MinIO to make sure that the image blobs are being written to the proper storage.</p><p><figure><img class="my-0 rounded-md" loading=lazy src=./data-lab-infra-platform-minio-gitlab-bucket.png alt="Data Lab Infra - Platform - MinIO GitLab Bucket"></figure></p><h4 class="relative group">CI/CD Workflows<div id=cicd-workflows class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#cicd-workflows aria-label=Anchor>#</a></span></h4><p>Again, on the <code>sandbox</code> repo, create the following <code>.gitlab-ci.yml</code> file:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yml data-lang=yml><span class=line><span class=cl><span class=nt>runner_info</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>lscpu</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>free -h</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>df -h /</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>echo &#34;USER:&#34; $SOME_USER</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>echo &#34;PASS:&#34; $SOME_PASS</span><span class=w>
</span></span></span></code></pre></div><p>Go into GitLab and, under the <code>sandbox</code> project, go to Settings â†’ CI/CD â†’ Variables â†’ CI/CD Variables â†’ Add variable, and add the <code>SOME_USER</code> and <code>SOME_PASS</code> variablesâ€”set the first one to &ldquo;Visible&rdquo; and the second one to &ldquo;Masked and hidden&rdquo;.</p><p><figure><img class="my-0 rounded-md" loading=lazy src=./data-lab-infra-platform-ci-cd-variables.png alt="Data Lab Infra - Platform - CI/CD Variables"></figure></p><p>Then you can add, commit and push:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git add .gitlab-ci.yml
</span></span><span class=line><span class=cl>git commit .gitlab-ci.yml -m <span class=s2>&#34;ci: basic task to test runner&#34;</span>
</span></span><span class=line><span class=cl>git push
</span></span></code></pre></div><p>The job will trigger immediately, and you&rsquo;ll be able to find its status and output under Build â†’ Jobs for the <code>sandbox</code> project. I also recommend that you pin this menu entry. You&rsquo;ll notice that the value of <code>SOME_USER</code> was correctly printed, while the value of <code>SOME_PASS</code> was be printed as <code>[MASKED]</code>.</p><p><figure><img class="my-0 rounded-md" loading=lazy src=./data-lab-infra-platform-job-log-1.png alt="Data Lab Infra - Platform - Job Log 1"></figure></p><p><figure><img class="my-0 rounded-md" loading=lazy src=./data-lab-infra-platform-job-log-2.png alt="Data Lab Infra - Platform - Job Log 2"></figure></p><p>Moving forward, we&rsquo;ll take advantage of the CI/CD features to setup a GitOps workflow to manage the docker compose stack for our data lab. Stay tuned for part 4 of this series!</p><h2 class="relative group">Final Remarks<div id=final-remarks class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#final-remarks aria-label=Anchor>#</a></span></h2><p>Despite a few bumps on the road, and questioning some decisions, we got it working smoothly in the end. Always expect the unexpected, a bit of a bumpy road, when working in operations. And be ready to make changes. Prioritize the robustness of your infrastructure rather than the successful execution of your original plan!</p><h3 class="relative group">On Configuration Management&mldr;<div id=on-configuration-management class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#on-configuration-management aria-label=Anchor>#</a></span></h3><p>To me, it remains unclear which configuration solution is preferrable, since, to be honest, I dislike them all.</p><p>Prebuilt images with Packer would have been ideal in a real-world scenario, if we wanted to eventually move out of qcow2 images on Proxmox VMs and into AMIs (Amazon Machine Images) on AWS EC2, but frankly this is overkill for a home lab.</p><p>I questioned my decision not to use Ansible, which might still be the best overall solution, but it still felt slightly overkill for this. So, I ended up going with cloud-init, as it&rsquo;s easily available on Proxmox, providing a few of the features that Ansible provides, but having a much simpler syntax. Although, of course, Ansible is more powerful and provides idempotency, while cloud-init is enough for most use cases, but runs only once per deployment.</p><h3 class="relative group">On GitLab&mldr;<div id=on-gitlab class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#on-gitlab aria-label=Anchor>#</a></span></h3><p>After working on GitLab deployment for a while, I questioned the decision to go with GitLab and asked myself if Gitea would have been a better and more lightweight option, with it being written in Go rather than Ruby, like GitLab.</p><p>While the apt package for GitLab installs flawlessly, and all the tooling is robust, there&rsquo;s a lot to improve as well. For example, most configs can be done via <code>/etc/gitlab/gitlab.rb</code>, which is not the best file format for configurations. Why not <code>toml</code> or <code>yaml</code> instead? And even disregarding that, a few configurations cannot be done via <code>gitlab.rb</code>, requiring <code>gitlab-rails console</code> instead. Fortunately it can read from the standard input, but it&rsquo;s also extremely slowâ€”I even thought there was some error as it was starting, because it took quite a while without producing any message whatsoever.</p><p>Regardless, I cannot complain much. Everything worked pretty much at first try, after following the documentation and asking ChatGPT a few things. Also, once deployed, performance is quite satisfactory, with GitLab being quite smooth to use.</p></div><div class="flex author"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width=96 height=96 alt="Data Lab Tech" src=/img/avatar_hub8180177579345e51fd02cb51345c99c_819528_192x192_fill_box_center_3.png><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Data Lab Tech</div><div class="text-sm text-neutral-700 dark:text-neutral-400"><a href=https://youtube.com/@DataLabTechTV target=_blank>https://youtube.com/@DataLabTechTV</a></div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://youtube.com/@DataLabTechTV target=_blank aria-label=Youtube rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentcolor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78.0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg></span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://bsky.app/profile/datalabtechtv.com target=_blank aria-label=Bluesky rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 232.562c-21.183-41.196-78.868-117.97-132.503-155.834-51.378-36.272-70.978-29.987-83.828-24.181-14.872 6.72-17.577 29.554-17.577 42.988.0 13.433 7.365 110.138 12.169 126.281 15.873 53.336 72.376 71.358 124.413 65.574 2.66-.395 5.357-.759 8.089-1.097-2.68.429-5.379.796-8.089 1.097-76.259 11.294-143.984 39.085-55.158 137.972C201.224 526.527 237.424 403.67 256 341.379c18.576 62.291 39.972 180.718 150.734 83.983 83.174-83.983 22.851-126.674-53.408-137.969-2.71-.302-5.409-.667-8.089-1.096 2.732.337 5.429.702 8.089 1.096 52.037 5.785 108.54-12.239 124.413-65.574 4.804-16.142 12.169-112.847 12.169-126.281.0-13.434-2.705-36.267-17.577-42.988-12.85-5.806-32.45-12.09-83.829 24.181C334.868 114.595 277.183 191.366 256 232.562z"/></svg></span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/DataLabTechTV target=_blank aria-label=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://discord.gg/6xpe827ANZ target=_blank aria-label=Discord rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentcolor" d="M524.531 69.836a1.5 1.5.0 00-.764-.7A485.065 485.065.0 00404.081 32.03a1.816 1.816.0 00-1.923.91 337.461 337.461.0 00-14.9 30.6 447.848 447.848.0 00-134.426.0 309.541 309.541.0 00-15.135-30.6 1.89 1.89.0 00-1.924-.91A483.689 483.689.0 00116.085 69.137a1.712 1.712.0 00-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.016 2.016.0 00.765 1.375A487.666 487.666.0 00176.02 479.918a1.9 1.9.0 002.063-.676A348.2 348.2.0 00208.12 430.4a1.86 1.86.0 00-1.019-2.588 321.173 321.173.0 01-45.868-21.853 1.885 1.885.0 01-.185-3.126c3.082-2.309 6.166-4.711 9.109-7.137a1.819 1.819.0 011.9-.256c96.229 43.917 200.41 43.917 295.5.0a1.812 1.812.0 011.924.233c2.944 2.426 6.027 4.851 9.132 7.16a1.884 1.884.0 01-.162 3.126 301.407 301.407.0 01-45.89 21.83 1.875 1.875.0 00-1 2.611 391.055 391.055.0 0030.014 48.815 1.864 1.864.0 002.063.7A486.048 486.048.0 00610.7 405.729a1.882 1.882.0 00.765-1.352C623.729 277.594 590.933 167.465 524.531 69.836zM222.491 337.58c-28.972.0-52.844-26.587-52.844-59.239S193.056 219.1 222.491 219.1c29.665.0 53.306 26.82 52.843 59.239.0 32.654-23.41 59.241-52.843 59.241zm195.38.0c-28.971.0-52.843-26.587-52.843-59.239S388.437 219.1 417.871 219.1c29.667.0 53.307 26.82 52.844 59.239.0 32.654-23.177 59.241-52.844 59.241z"/></svg></span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=mailto:mail@datalabtechtv.com target=_blank aria-label=Email rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg></span></span></a></div></div></div></div><div class=mb-10></div><section class="flex flex-row flex-wrap justify-center pt-4 text-xl"><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://datalabtechtv.com/posts/data-lab-infra-platform/&amp;title=Data%20Lab%20Infra%20-%20Part%203:%20Platform%20Setup%20with%20Terraform" title="Share on LinkedIn" aria-label="Share on LinkedIn"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://bsky.app/intent/compose?text=Data%20Lab%20Infra%20-%20Part%203:%20Platform%20Setup%20with%20Terraform+https://datalabtechtv.com/posts/data-lab-infra-platform/" title="Post on Bluesky" aria-label="Post on Bluesky"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 232.562c-21.183-41.196-78.868-117.97-132.503-155.834-51.378-36.272-70.978-29.987-83.828-24.181-14.872 6.72-17.577 29.554-17.577 42.988.0 13.433 7.365 110.138 12.169 126.281 15.873 53.336 72.376 71.358 124.413 65.574 2.66-.395 5.357-.759 8.089-1.097-2.68.429-5.379.796-8.089 1.097-76.259 11.294-143.984 39.085-55.158 137.972C201.224 526.527 237.424 403.67 256 341.379c18.576 62.291 39.972 180.718 150.734 83.983 83.174-83.983 22.851-126.674-53.408-137.969-2.71-.302-5.409-.667-8.089-1.096 2.732.337 5.429.702 8.089 1.096 52.037 5.785 108.54-12.239 124.413-65.574 4.804-16.142 12.169-112.847 12.169-126.281.0-13.434-2.705-36.267-17.577-42.988-12.85-5.806-32.45-12.09-83.829 24.181C334.868 114.595 277.183 191.366 256 232.562z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://s2f.kytta.dev/?text=Data%20Lab%20Infra%20-%20Part%203:%20Platform%20Setup%20with%20Terraform%20https://datalabtechtv.com/posts/data-lab-infra-platform/" title aria-label><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48.0.0.0-63.72 28.5-63.72 125.7.0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54.0 01-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://reddit.com/submit/?url=https://datalabtechtv.com/posts/data-lab-infra-platform/&amp;resubmit=true&amp;title=Data%20Lab%20Infra%20-%20Part%203:%20Platform%20Setup%20with%20Terraform" title="Submit to Reddit" aria-label="Submit to Reddit"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M201.5 305.5c-13.8.0-24.9-11.1-24.9-24.6.0-13.8 11.1-24.9 24.9-24.9 13.6.0 24.6 11.1 24.6 24.9.0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4.0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7.0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9.0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5.0 52.6 59.2 95.2 132 95.2 73.1.0 132.3-42.6 132.3-95.2.0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6.0-2.2-2.2-6.1-2.2-8.3.0-2.5 2.5-2.5 6.4.0 8.6 22.8 22.8 87.3 22.8 110.2.0 2.5-2.2 2.5-6.1.0-8.6-2.2-2.2-6.1-2.2-8.3.0zm7.7-75c-13.6.0-24.6 11.1-24.6 24.9.0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.1 24.9-24.6.0-13.8-11-24.9-24.9-24.9z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.facebook.com/sharer/sharer.php?u=https://datalabtechtv.com/posts/data-lab-infra-platform/&amp;quote=Data%20Lab%20Infra%20-%20Part%203:%20Platform%20Setup%20with%20Terraform" title="Share on Facebook" aria-label="Share on Facebook"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14.0 55.52 4.84 55.52 4.84v61h-31.28c-30.8.0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="mailto:?body=https://datalabtechtv.com/posts/data-lab-infra-platform/&amp;subject=Data%20Lab%20Infra%20-%20Part%203:%20Platform%20Setup%20with%20Terraform" title="Send via email" aria-label="Send via email"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://api.whatsapp.com/send?text=https://datalabtechtv.com/posts/data-lab-infra-platform/&amp;resubmit=true&amp;title=Data%20Lab%20Infra%20-%20Part%203:%20Platform%20Setup%20with%20Terraform" title="Share via WhatsApp" aria-label="Share via WhatsApp"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4.0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3.0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2.0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2.0-101.7 82.8-184.5 184.6-184.5 49.3.0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5.0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8s-14.3 18-17.6 21.8c-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2s-9.7 1.4-14.8 6.9c-5.1 5.6-19.4 19-19.4 46.3.0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/></svg></span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://t.me/share/url?url=https://datalabtechtv.com/posts/data-lab-infra-platform/&amp;resubmit=true&amp;title=Data%20Lab%20Infra%20-%20Part%203:%20Platform%20Setup%20with%20Terraform" title="Share via Telegram" aria-label="Share via Telegram"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M248 8C111.033 8 0 119.033.0 256S111.033 504 248 504 496 392.967 496 256 384.967 8 248 8zM362.952 176.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452.0 013.53 6.716A43.765 43.765.0 01362.952 176.66z"/></svg></span></a></section></div><script>var oid="views_posts/data-lab-infra-platform/index.md",oid_likes="likes_posts/data-lab-infra-platform/index.md"</script><script type=text/javascript src=/js/page.min.b06a29d42a4ed16787978e2eee1e8c797b7698db2bc14ccee78f5c80ac566fc996190a73ad80a5e987558474b20b96fa38f7d85b405f165ff72b7b163c5ad11b.js integrity="sha512-sGop1CpO0WeHl44u7h6MeXt2mNsrwUzO549cgKxWb8mWGQpzrYCl6YdVhHSyC5b6OPfYW0BfFl/3K3sWPFrRGw=="></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="flex group mr-3" href=/posts/data-lab-infra-foundation/><span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Data Lab Infra - Part 2: Bootstrapping with Terraform</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-09-23T12:00:00+01:00>23 September 2025</time></span></span></a></span>
<span><a class="flex text-right group ml-3" href=/posts/data-lab-infra-services/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Data Lab Infra - Part 4: Core Services</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-10-14T12:00:00+01:00>14 October 2025</time></span></span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&larr;</span></a></span></div></div></footer></article><div id=top-scroller class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 mt-8 print:hidden"><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex flex-col list-none sm:flex-row"><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/privacy/ title="Privacy Policy">Privacy</a></li><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/cookies/ title="Cookie Policy">Cookies</a></li><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a id=reset-cookie-options class="decoration-primary-500 flex items-center" href=# title="Reset Cookie Options"><span class=mr-1>ðŸª</span></a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2026
Data Lab Tech</p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.62060bb247f4de2b6dde45903668fefb68d792f365587605177b1227c0cf43588701edaca0cb40e2c8e2789bd5ce67c1d2a215b9fb258c3496a7cd25e7cb5fdf.js integrity="sha512-YgYLskf03itt3kWQNmj++2jXkvNlWHYFF3sSJ8DPQ1iHAe2soMtA4sjieJvVzmfB0qIVufsljDSWp80l58tf3w=="></script>
<script src=/js/search-keybind.min.b0547e1bcfb3922a05d78728999bbd36902e6c52a31b0b1efa373df47c6fa095.js integrity="sha256-sFR+G8+zkioF14comZu9NpAubFKjGwse+jc99HxvoJU=" crossorigin=anonymous></script><script src=/js/cookie-banner.min.010e183607b0d0550c6b0c6cdfee0ef6a8251e4995f06db7c9541c7a847f9751.js integrity="sha256-AQ4YNgew0FUMawxs3+4O9qglHkmV8G23yVQceoR/l1E=" crossorigin=anonymous></script><div id=cookie-spacer class="h-12 hidden"></div><div id=cookie-banner class="fixed inset-x-0 bottom-0 z-[90] hidden"><div class="opacity-90 backdrop-blur-2xl shadow-2xl px-4 py-4 text-sm text-white dark:text-neutral-100"><div class="max-w-[64rem] mx-auto flex flex-wrap items-center justify-between gap-4"><span>We use cookies to enhance your experience.
<a href=/privacy/ class="underline text-blue-300 hover:text-blue-100 ml-1">Learn more</a>.</span><div class="flex gap-4 shrink-0"><button id=cookie-decline class="font-medium text-gray-500 hover:text-primary-600 dark:hover:text-primary-400 cursor-pointer">
Decline</button>
<button id=cookie-accept class="font-medium text-gray-500 hover:text-primary-600 dark:hover:text-primary-400 cursor-pointer">
Accept</button></div></div></div></div><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
    mermaid.initialize({
        startOnLoad: true,
        theme: "base",
        themeCSS: `
           
          .nodeLabel {
            text-wrap: nowrap;
          }
        `,
        flowchart: {
            nodeSpacing: 20,
            rankSpacing: 100,
        },
        themeVariables: {
            fontFamily: 'var(--default-mono-font-family, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace)',
            fontSize: "1.5em",

            background: "#1e1e1e",
            textColor: "#f8fafc",
            primaryColor: "#0ea5e9",
            tertiaryColor: "#f8fafc",
            primaryTextColor: "#1e1e1e",
            lineColor: "#94a3b8",
            noteBkgColor: "#2c3a4a",

             
            nodeBorder: "#38bdf8",
            clusterBkg: "#2c3a4a",
            clusterBorder: "#4b5563",

             
            actorTextColor: "#f8fafc",
            loopTextColor: "#f8fafc",

             
            tagLabelFontSize: ".6em",
            commitLabelFontSize: ".6em",
            commitLabelColor: "#f8fafc",
            commitLabelBackground: "#2c3a4a",
            git0: "#0ea5e9",
            git1: "#4b5563",
        }
    });
</script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]" data-url=https://datalabtechtv.com/ style=z-index:500><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>